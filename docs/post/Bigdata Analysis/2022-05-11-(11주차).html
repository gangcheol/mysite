<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="GANGCHEOL LEE">
<meta name="dcterms.date" content="2022-05-11">

<title>Gangcheol - 12. Max pooling, CNN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Gangcheol</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../../about.html" aria-current="page">
 <span class="menu-text">About Me</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/gangcheol/"><i class="bi bi-github" role="img">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
              <div class="quarto-toggle-container">
                  <a href="" class="quarto-color-scheme-toggle nav-link" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
              </div>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">12. Max pooling, CNN</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../about.html" class="sidebar-item-text sidebar-link">About Me</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Post</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Bigdata Analysis</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-03-08-(1주차).html" class="sidebar-item-text sidebar-link">01. 단순선형회귀</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-03-14-(2주차).html" class="sidebar-item-text sidebar-link">02. Tensorflow-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-03-21-(3주차).html" class="sidebar-item-text sidebar-link">03. Tensorflow-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-03-28-(4주차).html" class="sidebar-item-text sidebar-link">04. 경사하강법-1</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-03-30-(5주차).html" class="sidebar-item-text sidebar-link">05. 경사하강법-2</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-04-11-(6주차).html" class="sidebar-item-text sidebar-link">06. layer</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2020-04-12-(6주차) 과제.html" class="sidebar-item-text sidebar-link">06. layer 과제</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-04-18-(7주차).html" class="sidebar-item-text sidebar-link">07. Adam</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-04-27-중간고사 해설.html" class="sidebar-item-text sidebar-link">08. Mid term</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-05-01-(9주차).html" class="sidebar-item-text sidebar-link">09. MLE</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-05-02-lecture.html" class="sidebar-item-text sidebar-link">10. 확률적 경사하강법</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-05-08-lecture.html" class="sidebar-item-text sidebar-link">11. softmax</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/Bigdata Analysis/2022-05-11-(11주차).html" class="sidebar-item-text sidebar-link active">12. Max pooling, CNN</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">ML with pytorch</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/ML with pytorch/2022-01-27-Intro.html" class="sidebar-item-text sidebar-link">0. Intro (MLP)</a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">R for the Data Scienece</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/R for the Data Scienece/2022-03-03-선형회귀분석.html" class="sidebar-item-text sidebar-link">선형회귀분석 기초 (RFD)</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../post/R for the Data Scienece/2023-01-26-quarto test.html" class="sidebar-item-text sidebar-link">Quarto test</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#imports" id="toc-imports" class="nav-link active" data-scroll-target="#imports">imports</a></li>
  <li><a href="#지난시간요약" id="toc-지난시간요약" class="nav-link" data-scroll-target="#지난시간요약">지난시간요약</a></li>
  <li><a href="#maxpooling" id="toc-maxpooling" class="nav-link" data-scroll-target="#maxpooling">maxpooling</a>
  <ul class="collapse">
  <li><a href="#테스트-1" id="toc-테스트-1" class="nav-link" data-scroll-target="#테스트-1">테스트 1</a></li>
  <li><a href="#테스트-2" id="toc-테스트-2" class="nav-link" data-scroll-target="#테스트-2">테스트 2</a></li>
  <li><a href="#테스트-3" id="toc-테스트-3" class="nav-link" data-scroll-target="#테스트-3">테스트 3</a></li>
  <li><a href="#테스트-4" id="toc-테스트-4" class="nav-link" data-scroll-target="#테스트-4">테스트 4</a></li>
  <li><a href="#테스트-5" id="toc-테스트-5" class="nav-link" data-scroll-target="#테스트-5">테스트 5</a></li>
  <li><a href="#테스트-6" id="toc-테스트-6" class="nav-link" data-scroll-target="#테스트-6">테스트 6</a></li>
  </ul></li>
  <li><a href="#convolution-2d" id="toc-convolution-2d" class="nav-link" data-scroll-target="#convolution-2d">Convolution 2D</a>
  <ul class="collapse">
  <li><a href="#conv-2d-요약" id="toc-conv-2d-요약" class="nav-link" data-scroll-target="#conv-2d-요약">Conv 2D 요약</a></li>
  <li><a href="#테스트-34-다시" id="toc-테스트-34-다시" class="nav-link" data-scroll-target="#테스트-34-다시"><code>-</code> 테스트 3,4 다시…</a></li>
  </ul></li>
  <li><a href="#텐서플로우를-공부하기-좋은-교재-혹은-참고자료" id="toc-텐서플로우를-공부하기-좋은-교재-혹은-참고자료" class="nav-link" data-scroll-target="#텐서플로우를-공부하기-좋은-교재-혹은-참고자료">텐서플로우를 공부하기 좋은 교재 혹은 참고자료</a>
  <ul class="collapse">
  <li><a href="#cnn의-시작-알렉스넷" id="toc-cnn의-시작-알렉스넷" class="nav-link" data-scroll-target="#cnn의-시작-알렉스넷">CNN의 시작: 알렉스넷</a></li>
  <li><a href="#d-convolution" id="toc-d-convolution" class="nav-link" data-scroll-target="#d-convolution">2d convolution</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">12. Max pooling, CNN</h1>
  <div class="quarto-categories">
    <div class="quarto-category">python</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>GANGCHEOL LEE </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 11, 2022</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="imports" class="level3">
<h3 class="anchored" data-anchor-id="imports">imports</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow.experimental.numpy <span class="im">as</span> tnp</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>tnp.experimental_enable_numpy_behavior()</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
</div>
</section>
<section id="지난시간요약" class="level3">
<h3 class="anchored" data-anchor-id="지난시간요약">지난시간요약</h3>
<p><code>-</code> 이미지자료의 정리</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:730,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696229897,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="9ebed808-a320-4ec3-a2df-0309514f6dbe">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(x_train, y_train), (x_test, y_test) <span class="op">=</span> tf.keras.datasets.fashion_mnist.load_data()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-labels-idx1-ubyte.gz
32768/29515 [=================================] - 0s 0us/step
40960/29515 [=========================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/train-images-idx3-ubyte.gz
26427392/26421880 [==============================] - 0s 0us/step
26435584/26421880 [==============================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-labels-idx1-ubyte.gz
16384/5148 [===============================================================================================] - 0s 0us/step
Downloading data from https://storage.googleapis.com/tensorflow/tf-keras-datasets/t10k-images-idx3-ubyte.gz
4423680/4422102 [==============================] - 0s 0us/step
4431872/4422102 [==============================] - 0s 0us/step</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696230747,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="afae5089-51cc-4e11-c7da-3ea20284f5e6">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>x_train.shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="5">
<pre><code>(60000, 28, 28)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3794,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696235630,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f8c1cfd3-21db-4a46-84dd-7a6994fd9b38">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>tf.constant(x_train.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">1</span>),dtype<span class="op">=</span>tf.float64).shape</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co">#tf.constant(x_train.reshape(60000,28,28,1),dtype=tf.float64).shape</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="6">
<pre><code>TensorShape([60000, 28, 28, 1])</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> tf.constant(x_train.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">1</span>),dtype<span class="op">=</span>tf.float64)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> tf.keras.utils.to_categorical(y_train)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>XX <span class="op">=</span> tf.constant(x_test.reshape(<span class="op">-</span><span class="dv">1</span>,<span class="dv">28</span>,<span class="dv">28</span>,<span class="dv">1</span>),dtype<span class="op">=</span>tf.float64)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>yy <span class="op">=</span> tf.keras.utils.to_categorical(y_test)</span></code></pre></div>
</div>
<p><code>-</code> net1,2</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:42239,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696356693,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="fa7f92e1-d3d1-4ecb-dd9c-cb013fcbb477">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>net1 <span class="op">=</span> tf.keras.Sequential()</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>net1.add(tf.keras.layers.Flatten()) <span class="co">## 데이터를 펼치는 과정</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>net1.add(tf.keras.layers.Dense(<span class="dv">30</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>net1.add(tf.keras.layers.Dense(<span class="dv">10</span>,activation<span class="op">=</span><span class="st">'softmax'</span>))</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>net1.<span class="bu">compile</span>(loss<span class="op">=</span>tf.losses.categorical_crossentropy,optimizer<span class="op">=</span><span class="st">'adam'</span>,metrics<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>net1.fit(X,y,epochs<span class="op">=</span><span class="dv">10</span>,verbose<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>&lt;keras.callbacks.History at 0x7ff3100d4ed0&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:5484,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696364880,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="4b0e7036-2d08-4b9f-a970-28ccfb47ed21">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>net1.evaluate(X,y)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1875/1875 [==============================] - 4s 2ms/step - loss: 0.6145 - accuracy: 0.7520</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>[0.614452600479126, 0.7520333528518677]</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:82651,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696468159,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="913ee2cf-bb5a-4211-b13b-0859045eeb08">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>net2 <span class="op">=</span> tf.keras.Sequential()</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>net2.add(tf.keras.layers.Flatten())</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>net2.add(tf.keras.layers.Dense(<span class="dv">500</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>net2.add(tf.keras.layers.Dense(<span class="dv">500</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>net2.add(tf.keras.layers.Dense(<span class="dv">500</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>net2.add(tf.keras.layers.Dense(<span class="dv">500</span>,activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>net2.add(tf.keras.layers.Dense(<span class="dv">10</span>,activation<span class="op">=</span><span class="st">'softmax'</span>))</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>net2.<span class="bu">compile</span>(loss<span class="op">=</span>tf.losses.categorical_crossentropy,optimizer<span class="op">=</span><span class="st">'adam'</span>,metrics<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>net2.fit(X,y,epochs<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
1875/1875 [==============================] - 6s 3ms/step - loss: 1.1154 - accuracy: 0.7879
Epoch 2/10
1875/1875 [==============================] - 6s 3ms/step - loss: 0.4502 - accuracy: 0.8384
Epoch 3/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.4117 - accuracy: 0.8536
Epoch 4/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3950 - accuracy: 0.8601
Epoch 5/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3770 - accuracy: 0.8663
Epoch 6/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3625 - accuracy: 0.8713
Epoch 7/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3498 - accuracy: 0.8760
Epoch 8/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3358 - accuracy: 0.8801
Epoch 9/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3328 - accuracy: 0.8817
Epoch 10/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3186 - accuracy: 0.8855</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>&lt;keras.callbacks.History at 0x7ff2a66f9e90&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1296,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696473021,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="e25af7e6-aecc-40a6-855e-4a64acfd7467">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>net2.evaluate(XX,yy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>313/313 [==============================] - 1s 2ms/step - loss: 0.3804 - accuracy: 0.8655</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>[0.38036859035491943, 0.8654999732971191]</code></pre>
</div>
</div>
<ul>
<li>DNN 아키텍처로는 한계가 있음</li>
<li>파라미터 개수가 늘어난 것에 비해 딱히 성능이 많이 좋아진 것 같지는 않음</li>
</ul>
<p><code>-</code> net3 : Conv2D + MaxPool2D</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:62650,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696609494,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="7272e176-e207-4334-8b54-ddf0d3f8b30d">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>net3 <span class="op">=</span> tf.keras.Sequential()</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>net3.add(tf.keras.layers.Conv2D(<span class="dv">30</span>,(<span class="dv">2</span>,<span class="dv">2</span>),activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>net3.add(tf.keras.layers.MaxPool2D()) <span class="co"># net3.add(tf.keras.layers.MaxPool2D(pool_size=(2,2)))와 동일한 코드</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>net3.add(tf.keras.layers.Conv2D(<span class="dv">30</span>,(<span class="dv">2</span>,<span class="dv">2</span>),activation<span class="op">=</span><span class="st">'relu'</span>))</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>net3.add(tf.keras.layers.MaxPool2D())</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>net3.add(tf.keras.layers.Flatten())</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>net3.add(tf.keras.layers.Dense(<span class="dv">10</span>,activation<span class="op">=</span><span class="st">'softmax'</span>))</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>net3.<span class="bu">compile</span>(loss<span class="op">=</span>tf.losses.categorical_crossentropy,optimizer<span class="op">=</span><span class="st">'adam'</span>,metrics<span class="op">=</span><span class="st">'accuracy'</span>)</span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>net3.fit(X,y,epochs<span class="op">=</span><span class="dv">10</span>)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/10
1875/1875 [==============================] - 14s 3ms/step - loss: 0.7710 - accuracy: 0.8084
Epoch 2/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3586 - accuracy: 0.8730
Epoch 3/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.3152 - accuracy: 0.8868
Epoch 4/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.2940 - accuracy: 0.8935
Epoch 5/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.2793 - accuracy: 0.8989
Epoch 6/10
1875/1875 [==============================] - 6s 3ms/step - loss: 0.2659 - accuracy: 0.9027
Epoch 7/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.2573 - accuracy: 0.9063
Epoch 8/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.2487 - accuracy: 0.9090
Epoch 9/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.2441 - accuracy: 0.9110
Epoch 10/10
1875/1875 [==============================] - 5s 3ms/step - loss: 0.2380 - accuracy: 0.9118</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>&lt;keras.callbacks.History at 0x7ff2a656e3d0&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1561,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696635509,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="5f9bca7e-0bcb-4bfc-9338-8ea2dc563a2f">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>net3.evaluate(XX,yy)</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>313/313 [==============================] - 1s 3ms/step - loss: 0.3457 - accuracy: 0.8801</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>[0.3457203209400177, 0.8801000118255615]</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:301,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696826704,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6fffba15-3ad2-42a5-d542-690504879f50">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>net2.summary()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_2 (Flatten)         (None, 784)               0         
                                                                 
 dense_4 (Dense)             (None, 500)               392500    
                                                                 
 dense_5 (Dense)             (None, 500)               250500    
                                                                 
 dense_6 (Dense)             (None, 500)               250500    
                                                                 
 dense_7 (Dense)             (None, 500)               250500    
                                                                 
 dense_8 (Dense)             (None, 10)                5010      
                                                                 
=================================================================
Total params: 1,149,010
Trainable params: 1,149,010
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:273,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696820701,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0bebea6b-1c56-4dcd-efa6-6ac32f61f872">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>net3.summary()</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 27, 27, 30)        150       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 13, 13, 30)       0         
 )                                                               
                                                                 
 conv2d_1 (Conv2D)           (None, 12, 12, 30)        3630      
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 6, 6, 30)         0         
 2D)                                                             
                                                                 
 flatten_3 (Flatten)         (None, 1080)              0         
                                                                 
 dense_9 (Dense)             (None, 10)                10810     
                                                                 
=================================================================
Total params: 14,590
Trainable params: 14,590
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<ul>
<li>DNN의 한계(모형이 너무 복잡합)를 가볍게 돌파</li>
</ul>
<p><code>-</code> net3의 구조 감상</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:295,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696891166,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="402b1100-42e9-4bf6-d39f-89099a9f7777">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>net3.layers</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="23">
<pre><code>[&lt;keras.layers.convolutional.Conv2D at 0x7ff2a6550050&gt;,
 &lt;keras.layers.pooling.MaxPooling2D at 0x7ff2a6550c90&gt;,
 &lt;keras.layers.convolutional.Conv2D at 0x7ff3100b67d0&gt;,
 &lt;keras.layers.pooling.MaxPooling2D at 0x7ff2a655e890&gt;,
 &lt;keras.layers.core.flatten.Flatten at 0x7ff2a655e710&gt;,
 &lt;keras.layers.core.dense.Dense at 0x7ff2a654cf10&gt;]</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>cv1, mp1, cv2, mp2, flttn, d1 <span class="op">=</span> net3.layers</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1005,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696904678,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="63a59e56-c711-4282-b7af-ad09d3db1664">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(XX.shape) <span class="co">## 이미지 (2D)</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv1(XX).shape) <span class="co">## 이미지 (2D)</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mp1(cv1(XX)).shape) <span class="co">## 이미지 (2D)</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv2(mp1(cv1(XX))).shape) <span class="co">## 이미지 (2D) </span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(mp2(cv2(mp1(cv1(XX)))).shape) <span class="co">## 이미지 (2D) </span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(flttn(mp2(cv2(mp1(cv1(XX))))).shape) <span class="co">## 이미지를 펼친것 (1D) </span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(d1(flttn(mp2(cv2(mp1(cv1(XX)))))).shape) <span class="co">## 이미지를 펼친것 (1D) </span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(10000, 28, 28, 1)
(10000, 27, 27, 30)
(10000, 13, 13, 30)
(10000, 12, 12, 30)
(10000, 6, 6, 30)
(10000, 1080)
(10000, 10)</code></pre>
</div>
</div>
<ul>
<li>복잡한거아냐?</li>
</ul>
<p><code>-</code> 파라메터 비교</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:268,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696924812,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="b830e87e-cfe2-4234-e236-de0d6eace60b">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>net1.summary() <span class="co">## 23,860</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_1"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_1 (Flatten)         (32, 784)                 0         
                                                                 
 dense_2 (Dense)             (32, 30)                  23550     
                                                                 
 dense_3 (Dense)             (32, 10)                  310       
                                                                 
=================================================================
Total params: 23,860
Trainable params: 23,860
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:293,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696926295,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="3bd62e7c-c11a-4ea4-b8f0-b6fe94d1a1dd">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>net2.summary() <span class="co"># 1,149,010</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_2"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 flatten_2 (Flatten)         (None, 784)               0         
                                                                 
 dense_4 (Dense)             (None, 500)               392500    
                                                                 
 dense_5 (Dense)             (None, 500)               250500    
                                                                 
 dense_6 (Dense)             (None, 500)               250500    
                                                                 
 dense_7 (Dense)             (None, 500)               250500    
                                                                 
 dense_8 (Dense)             (None, 10)                5010      
                                                                 
=================================================================
Total params: 1,149,010
Trainable params: 1,149,010
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:263,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652696928040,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f10aa920-9710-4ad0-c3f4-917f3e3fa9be">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>net3.summary() <span class="co"># 14,590</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential_3"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 conv2d (Conv2D)             (None, 27, 27, 30)        150       
                                                                 
 max_pooling2d (MaxPooling2D  (None, 13, 13, 30)       0         
 )                                                               
                                                                 
 conv2d_1 (Conv2D)           (None, 12, 12, 30)        3630      
                                                                 
 max_pooling2d_1 (MaxPooling  (None, 6, 6, 30)         0         
 2D)                                                             
                                                                 
 flatten_3 (Flatten)         (None, 1080)              0         
                                                                 
 dense_9 (Dense)             (None, 10)                10810     
                                                                 
=================================================================
Total params: 14,590
Trainable params: 14,590
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:291,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652697838288,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="7d5eaabb-8d66-48ae-b0e5-3179b390fd79">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="dv">14590</span><span class="op">/</span><span class="dv">23860</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="29">
<pre><code>0.6114836546521375</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652697839434,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="8f1195f2-6d30-44c7-e40f-107558dbaa88">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="dv">14590</span><span class="op">/</span><span class="dv">1149010</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>0.012697887746842934</code></pre>
</div>
</div>
</section>
<section id="maxpooling" class="level2">
<h2 class="anchored" data-anchor-id="maxpooling">maxpooling</h2>
<section id="테스트-1" class="level3">
<h3 class="anchored" data-anchor-id="테스트-1">테스트 1</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>m <span class="op">=</span> tf.keras.layers.MaxPool2D()</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652697981343,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="e3675515-7cc3-467a-a947-f0332966fee6">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">1</span>)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>XXX</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>&lt;tf.Tensor: shape=(16,), dtype=int64, numpy=array([ 0,  1,  2,  3,  4,  5,  6,  7,  8,  9, 10, 11, 12, 13, 14, 15])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:263,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698003616,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="89e6af23-7c91-4f41-d42b-0f6d147993a3">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> XXX.reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>) <span class="co">## 컬러이미지</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>XXX</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>&lt;tf.Tensor: shape=(1, 4, 4, 1), dtype=int64, numpy=
array([[[[ 0],
         [ 1],
         [ 2],
         [ 3]],

        [[ 4],
         [ 5],
         [ 6],
         [ 7]],

        [[ 8],
         [ 9],
         [10],
         [11]],

        [[12],
         [13],
         [14],
         [15]]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698030810,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="dee18746-8b47-4b79-c61a-0af3cea15783">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>) <span class="co">## 흑백이미지</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="36">
<pre><code>&lt;tf.Tensor: shape=(1, 4, 4), dtype=int64, numpy=
array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11],
        [12, 13, 14, 15]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:300,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698061676,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="5c984dab-c8e2-45fd-9963-f50df26bad57">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>m(XXX)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="38">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2, 1), dtype=int64, numpy=
array([[[[ 5],
         [ 7]],

        [[13],
         [15]]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698068150,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c0457f03-581d-464a-d303-a6fbea7abe24">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>m(XXX).reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="39">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
array([[[ 5,  7],
        [13, 15]]])&gt;</code></pre>
</div>
</div>
<ul>
<li><p>눈치껏 <code>XXX.reshape(1,4,4)</code>에서 각각의 <code>2 x 2</code>에서 가장 큰 값을 찾아주는 것으로 생각하자.</p></li>
<li><p>즉, <code>2 x 2</code>의 window를 만들고 그 중 가장 기록 후 윈도우를 움직이면서 이 과정을 반복한다.</p></li>
</ul>
</section>
<section id="테스트-2" class="level3">
<h3 class="anchored" data-anchor-id="테스트-2">테스트 2</h3>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:1,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698315450,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="fcd00454-228a-4d5a-b782-2bcf422f75ed">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">6</span><span class="op">*</span><span class="dv">6</span><span class="op">*</span><span class="dv">1</span>).reshape(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">1</span>)</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">6</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>&lt;tf.Tensor: shape=(1, 6, 6), dtype=int64, numpy=
array([[[ 0,  1,  2,  3,  4,  5],
        [ 6,  7,  8,  9, 10, 11],
        [12, 13, 14, 15, 16, 17],
        [18, 19, 20, 21, 22, 23],
        [24, 25, 26, 27, 28, 29],
        [30, 31, 32, 33, 34, 35]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698326223,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="a35042b0-ffb8-4902-c9e4-5f00b9463913">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>m(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>&lt;tf.Tensor: shape=(1, 3, 3), dtype=int64, numpy=
array([[[ 7,  9, 11],
        [19, 21, 23],
        [31, 33, 35]]])&gt;</code></pre>
</div>
</div>
<ul>
<li>윈도우 크기 <code>2 x 2</code>는 디폴트 값이다!!</li>
</ul>
</section>
<section id="테스트-3" class="level3">
<h3 class="anchored" data-anchor-id="테스트-3">테스트 3</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>m<span class="op">=</span>tf.keras.layers.MaxPool2D(pool_size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:264,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698432640,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="2c6ecca4-547b-44ce-ed2f-c2b115ed26ac">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">6</span><span class="op">*</span><span class="dv">6</span><span class="op">*</span><span class="dv">1</span>).reshape(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">6</span>,<span class="dv">1</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">6</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>&lt;tf.Tensor: shape=(1, 6, 6), dtype=int64, numpy=
array([[[ 0,  1,  2,  3,  4,  5],
        [ 6,  7,  8,  9, 10, 11],
        [12, 13, 14, 15, 16, 17],
        [18, 19, 20, 21, 22, 23],
        [24, 25, 26, 27, 28, 29],
        [30, 31, 32, 33, 34, 35]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:264,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698439055,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6641babd-530f-4252-8b04-52bc8ee31ce0">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>m(XXX).reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="44">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
array([[[14, 17],
        [32, 35]]])&gt;</code></pre>
</div>
</div>
</section>
<section id="테스트-4" class="level3">
<h3 class="anchored" data-anchor-id="테스트-4">테스트 4</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>m<span class="op">=</span>tf.keras.layers.MaxPool2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698846739,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="355a4226-bac5-4f45-d421-8c1c6a58fd44">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">5</span><span class="op">*</span><span class="dv">5</span><span class="op">*</span><span class="dv">1</span>).reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="55">
<pre><code>&lt;tf.Tensor: shape=(1, 5, 5), dtype=int64, numpy=
array([[[ 0,  1,  2,  3,  4],
        [ 5,  6,  7,  8,  9],
        [10, 11, 12, 13, 14],
        [15, 16, 17, 18, 19],
        [20, 21, 22, 23, 24]]])&gt;</code></pre>
</div>
</div>
<ul>
<li>차원이 안맞는 부분은 버리고 계산한다.</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698847882,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="1edf1bc8-d165-4331-fadf-e0dcdff2799d">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>m(XXX).reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>) <span class="co">## 어? 뒤에 나머지 5행과 5열은 버리고 계산한다....</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="56">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
array([[[ 6,  8],
        [16, 18]]])&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ?tf.keras.layers.MaxPool2D</span></span></code></pre></div>
</div>
<ul>
<li><code>padding</code> 옵션을 <code>same</code>으로 주면 남는 차원을 버리지 않음</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>m<span class="op">=</span>tf.keras.layers.MaxPool2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>),padding<span class="op">=</span><span class="st">"same"</span>)</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:272,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698727542,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="4b31bc1d-8cc9-478e-d3d9-c5e045318712">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>m(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>) </span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="53">
<pre><code>&lt;tf.Tensor: shape=(1, 3, 3), dtype=int64, numpy=
array([[[ 6,  8,  9],
        [16, 18, 19],
        [21, 23, 24]]])&gt;</code></pre>
</div>
</div>
</section>
<section id="테스트-5" class="level3">
<h3 class="anchored" data-anchor-id="테스트-5">테스트 5</h3>
<ul>
<li>관측치가 2개 채널(색)은 흑백</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>m<span class="op">=</span>tf.keras.layers.MaxPool2D(pool_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:272,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698976832,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c1604c3c-ff9a-4fbc-ffb0-af95ede55ce3">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">2</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">1</span>).reshape(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>&lt;tf.Tensor: shape=(2, 4, 4), dtype=int64, numpy=
array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11],
        [12, 13, 14, 15]],

       [[16, 17, 18, 19],
        [20, 21, 22, 23],
        [24, 25, 26, 27],
        [28, 29, 30, 31]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:275,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652698988070,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="410df858-a899-4a89-d765-114ae12e31af">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>m(XXX).reshape(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>) </span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="60">
<pre><code>&lt;tf.Tensor: shape=(2, 2, 2), dtype=int64, numpy=
array([[[ 5,  7],
        [13, 15]],

       [[21, 23],
        [29, 31]]])&gt;</code></pre>
</div>
</div>
</section>
<section id="테스트-6" class="level3">
<h3 class="anchored" data-anchor-id="테스트-6">테스트 6</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">3</span>).reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">3</span>)</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652699145988,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="be8fa7d2-2ead-401e-9e2c-a05e27b220db">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>XXX[:,:,:,<span class="dv">0</span>] <span class="co">## 첫번째 채널</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="68">
<pre><code>&lt;tf.Tensor: shape=(1, 4, 4), dtype=int64, numpy=
array([[[ 0,  3,  6,  9],
        [12, 15, 18, 21],
        [24, 27, 30, 33],
        [36, 39, 42, 45]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:256,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652699084901,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="d3e7bd89-32fe-403f-d378-a91d07394b07">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>m(XXX)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="64">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2, 3), dtype=int64, numpy=
array([[[[15, 16, 17],
         [21, 22, 23]],

        [[39, 40, 41],
         [45, 46, 47]]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652699156692,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0dd009ec-ed01-4ac2-d09e-44eed9ae79d4">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>m(XXX)[:,:,:,<span class="dv">0</span>] <span class="co">## 첫번째 채널</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="69">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2), dtype=int64, numpy=
array([[[15, 21],
        [39, 45]]])&gt;</code></pre>
</div>
</div>
</section>
</section>
<section id="convolution-2d" class="level2">
<h2 class="anchored" data-anchor-id="convolution-2d">Convolution 2D</h2>
<p><code>-</code> 테스트 1</p>
<p><code>-</code> 레이어 생성</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">1</span>, kernel_size <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
</div>
<p><code>-</code> XXX 생성</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:301,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700252267,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="d277e33c-0b67-4014-9625-a645e04592eb">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">1</span>,dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>) <span class="co">### 4 x 4 픽셀을 가진 이미지 생성</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>) </span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="88">
<pre><code>&lt;tf.Tensor: shape=(1, 4, 4), dtype=float64, numpy=
array([[[ 0.,  1.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.],
        [12., 13., 14., 15.]]])&gt;</code></pre>
</div>
</div>
<ul>
<li>아래가 에러가 나는 이유
<ul>
<li>데이터 타입이 int가 아닌 float이어야한다.</li>
<li>또한 차원을 <code>XXX.reshape(1,4,4)</code>로 입력하면 에러가 난다.</li>
</ul></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700253146,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="42f3143c-0fd1-4b7a-84ac-f0770d17d2c9">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>cv(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="89">
<pre><code>&lt;tf.Tensor: shape=(1, 3, 3), dtype=float32, numpy=
array([[[-4.290876 , -4.5067925, -4.722709 ],
        [-5.154542 , -5.3704586, -5.5863748],
        [-6.0182076, -6.234124 , -6.45004  ]]], dtype=float32)&gt;</code></pre>
</div>
</div>
<ul>
<li><p>사칙연산, max 이런 형태로 데이터가 변환되서 출력 되는 것이 아닌 것 같음</p></li>
<li><p>또한, 레이어의 가중치가 랜덤으로 배정되는 것 같음</p></li>
</ul>
<p><code>-</code> 코드 정리 + 시드통일</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:392,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700355653,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="8c334c71-cbd2-4b70-ef46-d999765598c4">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>cv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">1</span>, kernel_size <span class="op">=</span> (<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">4</span><span class="op">*</span><span class="dv">1</span>,dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(XXX.reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>)) </span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(
[[[ 0.  1.  2.  3.]
  [ 4.  5.  6.  7.]
  [ 8.  9. 10. 11.]
  [12. 13. 14. 15.]]], shape=(1, 4, 4), dtype=float64)
tf.Tensor(
[[[ -4.125754   -5.312817   -6.4998803]
  [ -8.874006  -10.0610695 -11.248133 ]
  [-13.622259  -14.809322  -15.996386 ]]], shape=(1, 3, 3), dtype=float32)</code></pre>
</div>
</div>
<ul>
<li><p>dense layer를 생각해보면 가중치가 랜덤으로 배정되기 때문에 시드를 고정해주었다.</p></li>
<li><p>weight를 한번 찍어보자</p></li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:260,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700413722,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="1ca300da-a50e-4d17-a2dd-13859e09bc1a">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>cv.weights</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="94">
<pre><code>[&lt;tf.Variable 'conv2d_7/kernel:0' shape=(2, 2, 1, 1) dtype=float32, numpy=
 array([[[[-0.13014299]],
 
         [[-0.23927206]]],
 
 
        [[[-0.20175874]],
 
         [[-0.6158894 ]]]], dtype=float32)&gt;,
 &lt;tf.Variable 'conv2d_7/bias:0' shape=(1,) dtype=float32, numpy=array([0.], dtype=float32)&gt;]</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700437377,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="cb5a205d-0e60-4ad6-d061-2433a3b01a5c">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="bu">type</span>(cv.weights) <span class="co">## 길이가 2인 리스트가 출력</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="95">
<pre><code>list</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:257,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700464669,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="1c3eb995-425c-43da-f889-665d54805bf1">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>cv.weights[<span class="dv">0</span>]</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="96">
<pre><code>&lt;tf.Variable 'conv2d_7/kernel:0' shape=(2, 2, 1, 1) dtype=float32, numpy=
array([[[[-0.13014299]],

        [[-0.23927206]]],


       [[[-0.20175874]],

        [[-0.6158894 ]]]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:258,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700556467,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f1e24563-a5c3-4e51-9fdf-39afe87afca4">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(XXX.reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>)) </span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>tf.reshape(cv.weights[<span class="dv">0</span>],(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(
[[[ 0.  1.  2.  3.]
  [ 4.  5.  6.  7.]
  [ 8.  9. 10. 11.]
  [12. 13. 14. 15.]]], shape=(1, 4, 4), dtype=float64)</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="100">
<pre><code>&lt;tf.Tensor: shape=(2, 2), dtype=float32, numpy=
array([[-0.13014299, -0.23927206],
       [-0.20175874, -0.6158894 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<p><code>-</code> 연산과정</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:263,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700718170,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="6e15d3a5-78ed-4ee0-f2e5-bb39b0034221">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span><span class="op">*-</span><span class="fl">0.13014299</span> <span class="op">+</span> <span class="dv">1</span><span class="op">*-</span><span class="fl">0.23927206</span> <span class="op">+</span> <span class="dv">4</span><span class="op">*-</span><span class="fl">0.20175874</span> <span class="op">+</span> <span class="dv">5</span><span class="op">*-</span><span class="fl">0.6158894</span> <span class="op">+</span><span class="dv">0</span> <span class="co">## 0 은 bias</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="104">
<pre><code>-4.1257540200000005</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700636240,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="728f5363-5c06-4553-d7ff-3c819bd9a575">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(cv(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(
[[[ -4.125754   -5.312817   -6.4998803]
  [ -8.874006  -10.0610695 -11.248133 ]
  [-13.622259  -14.809322  -15.996386 ]]], shape=(1, 3, 3), dtype=float32)</code></pre>
</div>
</div>
<p><code>-</code> weight를 변경해보자</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:259,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700811659,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="4cd2005f-8d2d-4385-fa31-c23666de9eee">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>cv.get_weights()[<span class="dv">0</span>].shape</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="108">
<pre><code>(2, 2, 1, 1)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> tnp.array([<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>,<span class="dv">1</span><span class="op">/</span><span class="dv">4</span>],dtype<span class="op">=</span>tf.float32).reshape(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> tnp.array([<span class="dv">3</span>],dtype<span class="op">=</span>tf.float32)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>cv.set_weights([w,b])</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:263,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652700987041,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0ad8bf08-2cb5-482b-80e9-186d791ae7af">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">4</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="119">
<pre><code>&lt;tf.Tensor: shape=(1, 4, 4), dtype=float64, numpy=
array([[[ 0.,  1.,  2.,  3.],
        [ 4.,  5.,  6.,  7.],
        [ 8.,  9., 10., 11.],
        [12., 13., 14., 15.]]])&gt;</code></pre>
</div>
</div>
<p><code>w</code>는 0,1,4,5를 평균내기위한 weight 값으로 설정한 것이다.</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652701082213,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c0dda01c-e4d5-4665-c1a8-d98761169268">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>cv(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="123">
<pre><code>&lt;tf.Tensor: shape=(1, 3, 3), dtype=float32, numpy=
array([[[ 5.5,  6.5,  7.5],
        [ 9.5, 10.5, 11.5],
        [13.5, 14.5, 15.5]]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652701085815,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f46712e5-6d00-4dba-a91d-3979ee0f8337">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a>tnp.mean([<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">4</span>,<span class="dv">5</span>])<span class="op">+</span><span class="dv">3</span>,tnp.mean([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">6</span>])<span class="op">+</span><span class="dv">3</span>,tnp.mean([<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">6</span>,<span class="dv">7</span>])<span class="op">+</span><span class="dv">3</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="124">
<pre><code>(&lt;tf.Tensor: shape=(), dtype=float64, numpy=5.5&gt;,
 &lt;tf.Tensor: shape=(), dtype=float64, numpy=6.5&gt;,
 &lt;tf.Tensor: shape=(), dtype=float64, numpy=7.5&gt;)</code></pre>
</div>
</div>
<section id="conv-2d-요약" class="level3">
<h3 class="anchored" data-anchor-id="conv-2d-요약">Conv 2D 요약</h3>
<ol type="1">
<li><p>size = (2,2)인 윈도우를 만든다.</p></li>
<li><p>XXX에 윈도우를 통과시켜서 (2,2)크기의 <code>sub XXX</code>를 얻음, <code>sub XXX</code>의 각 원소에 <code>conv2d.weights[0]</code>의 각 원소를 <code>element-wise</code>하게 곱한다.</p></li>
<li><p>(2)의 결과를 모두 더한다.</p></li>
<li><p>위 과정을 <code>window</code>를 이동시키면서 반복!</p></li>
</ol>
<p><code>-</code> 테스트 2</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">1</span>,(<span class="dv">3</span>,<span class="dv">3</span>))</span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">5</span><span class="op">*</span><span class="dv">5</span><span class="op">*</span><span class="dv">1</span>,dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:275,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652701727682,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="047d84ae-ebbb-4210-b0b4-9dbcc2a349fb">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="156">
<pre><code>&lt;tf.Tensor: shape=(1, 5, 5), dtype=float64, numpy=
array([[[ 0.,  1.,  2.,  3.,  4.],
        [ 5.,  6.,  7.,  8.,  9.],
        [10., 11., 12., 13., 14.],
        [15., 16., 17., 18., 19.],
        [20., 21., 22., 23., 24.]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:280,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652701731341,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="7841b939-dc3b-4452-f3e1-2a6fd23b5c56">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>tf.reshape(cnv.weights[<span class="dv">0</span>],(<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="158">
<pre><code>&lt;tf.Tensor: shape=(3, 3), dtype=float32, numpy=
array([[-0.08676198, -0.1595147 , -0.13450584],
       [-0.4105929 , -0.38366908,  0.07744962],
       [-0.09255642,  0.4915564 ,  0.20828158]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:422,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652701743413,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="ac55cb57-0fba-4c95-cc0b-a4d67442079d">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>cnv(XXX).reshape(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">3</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="160">
<pre><code>&lt;tf.Tensor: shape=(1, 3, 3), dtype=float32, numpy=
array([[[ 2.7395768 ,  2.2492635 ,  1.7589504 ],
        [ 0.28801066, -0.20230258, -0.6926158 ],
        [-2.1635566 , -2.6538715 , -3.1441827 ]]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:252,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652701744984,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="7cd9eb4f-cb4b-437c-bbc1-529f203fba4a">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_sum(XXX.reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)[<span class="dv">0</span>,:<span class="dv">3</span>,:<span class="dv">3</span>] <span class="op">*</span> tf.reshape(cnv.weights[<span class="dv">0</span>],(<span class="dv">3</span>,<span class="dv">3</span>)))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="161">
<pre><code>&lt;tf.Tensor: shape=(), dtype=float64, numpy=2.739577144384384&gt;</code></pre>
</div>
</div>
<p><code>-</code> 테스트 3</p>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652703018619,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="0c1b26d6-b410-4436-8610-2510dae71ee1">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tf.constant([[<span class="dv">3</span>,<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">1</span>],[<span class="dv">3</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>],[<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>],[<span class="dv">2</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>]],dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">1</span>)</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>XXX.reshape(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="169">
<pre><code>&lt;tf.Tensor: shape=(1, 5, 5), dtype=float64, numpy=
array([[[3., 3., 2., 1., 0.],
        [0., 0., 1., 3., 1.],
        [3., 1., 2., 2., 3.],
        [2., 0., 0., 2., 2.],
        [2., 0., 0., 0., 1.]]])&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>_w <span class="op">=</span> tf.constant([[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>]],dtype <span class="op">=</span> tf.float64)</span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>_b <span class="op">=</span> tf.constant([<span class="dv">0</span>],dtype<span class="op">=</span>tf.float64)</span></code></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>cnv<span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">1</span>, kernel_size <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">3</span>))</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:3,&quot;status&quot;:&quot;error&quot;,&quot;timestamp&quot;:1652703339303,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="74333a5d-ce38-4355-ad69-a117a7edb752">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>cnv.set_weights([_w,_b])</span></code></pre></div>
<div class="cell-output cell-output-error">
<pre><code>ValueError: ignored</code></pre>
</div>
</div>
<p><code>-</code> 테스트 4</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">1</span>,kernel_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>XXX </span></code></pre></div>
</div>
</section>
<section id="테스트-34-다시" class="level3">
<h3 class="anchored" data-anchor-id="테스트-34-다시"><code>-</code> 테스트 3,4 다시…</h3>
<p><code>-</code> 테스트 5</p>
<ul>
<li>관측치는 고정이고 출력채널이 바뀔 때</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">4</span>,kernel_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co">## 출력채널이 1인 경우 값이 1개 나옴 element wise 정확히 알아야한다</span></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.arange(<span class="dv">1</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">1</span>,dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:273,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652703756343,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="e498221d-f13b-4985-d4a9-047f553c947a">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(XXX.reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(
[[[0. 1.]
  [2. 3.]]], shape=(1, 2, 2), dtype=float64)</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652703757085,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="f270615a-b29b-46bf-9df8-6bf469b779ef">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>cnv(XXX)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="207">
<pre><code>&lt;tf.Tensor: shape=(1, 1, 1, 4), dtype=float32, numpy=
array([[[[ 1.048703  , -1.0948269 , -0.04476056, -1.7289025 ]]]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:255,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652703818879,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="1da6a9ef-31f4-4e52-9f10-3ab156c6cc2c">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>cnv.weights[<span class="dv">0</span>] <span class="co"># (2 x 2)커널의크기 // 1은 XXX의 채널 수 // 4는 con(XXX)의 채널수</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="209">
<pre><code>&lt;tf.Variable 'conv2d_28/kernel:0' shape=(2, 2, 1, 4) dtype=float32, numpy=
array([[[[-0.08230966, -0.15132892, -0.12760344, -0.38952267]],

        [[-0.36398047,  0.07347518, -0.08780673,  0.46633136]]],


       [[[ 0.19759327, -0.46042526, -0.15406173, -0.34838456]],

        [[ 0.33916563, -0.08248386,  0.11705655, -0.49948823]]]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:270,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652703881219,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="b635807d-c4b2-43a9-a720-4373c667b50c">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>].reshape(<span class="dv">2</span>,<span class="dv">2</span>) <span class="co">## conv(XXX)의 첫 번째 채널의 weight 값</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="214">
<pre><code>&lt;tf.Tensor: shape=(2, 2), dtype=float32, numpy=
array([[-0.08230966, -0.36398047],
       [ 0.19759327,  0.33916563]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652703939175,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="5fa977a5-162e-483e-a395-f268944b1c88">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_sum(XXX.reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>) <span class="op">*</span> cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>].reshape(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co">## 이는 Conv 2D를 거쳐 나오는 첫번째 출력 값</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="217">
<pre><code>&lt;tf.Tensor: shape=(), dtype=float64, numpy=1.0487029552459717&gt;</code></pre>
</div>
</div>
<ul>
<li><p>채널을 뻥튀기한다 <span class="math inline">\(\to\)</span> 아무의미없다 그냥 늘리는 것이다 $ $ 그냥 파라미터를 많이 써서 뻥튀기하는 것이다.</p></li>
<li><p>원래 채널은 3개(색깔)지만 그냥 모델을 복잡하게 해서 뻥튀기를 하는 것이다.</p></li>
</ul>
<p><code>-</code> 테스트 6</p>
<ul>
<li>X의 채널이 여러개고, Conv의 채널도 여러개 일때</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">4</span>,kernel_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.array([<span class="dv">1</span>]<span class="op">*</span><span class="dv">1</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">1</span>,dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:255,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704269938,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="a667f10f-bc89-4ce9-b813-e61dd0bfc703">
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(XXX.reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(
[[[1. 1.]
  [1. 1.]]], shape=(1, 2, 2), dtype=float64)</code></pre>
</div>
</div>
<ul>
<li>위와같이 <code>XXX</code>를 설정하면 <code>cnv(XXX)</code>의 결과는 단지 cnv의 <code>weigth</code>들의 합이 된다.</li>
</ul>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:345,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704330688,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="26600dfb-84af-45d1-8461-e74dac363a9c">
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>cnv(XXX)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="221">
<pre><code>&lt;tf.Tensor: shape=(1, 1, 1, 4), dtype=float32, numpy=
array([[[[ 0.09046876, -0.6207628 , -0.25241536, -0.7710641 ]]]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:260,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704339716,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="fd521bbc-83f6-47b2-cdd3-1f89428ed89a">
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>cnv.weights[<span class="dv">0</span>] <span class="co"># (2 x 2)커널의크기 // 1은 XXX의 채널 수 // 4는 con(XXX)의 채널수</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="222">
<pre><code>&lt;tf.Variable 'conv2d_29/kernel:0' shape=(2, 2, 1, 4) dtype=float32, numpy=
array([[[[-0.08230966, -0.15132892, -0.12760344, -0.38952267]],

        [[-0.36398047,  0.07347518, -0.08780673,  0.46633136]]],


       [[[ 0.19759327, -0.46042526, -0.15406173, -0.34838456]],

        [[ 0.33916563, -0.08248386,  0.11705655, -0.49948823]]]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704394408,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c7fd8138-993f-4c19-f7a1-7945e235bcad">
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_sum(cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>]) <span class="op">==</span> tf.reduce_sum(XXX.reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>) <span class="op">*</span> cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>].reshape(<span class="dv">2</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="227">
<pre><code>&lt;tf.Tensor: shape=(), dtype=bool, numpy=True&gt;</code></pre>
</div>
</div>
<ul>
<li>계산결과를 확인하기 쉽게 만든 약간의 트릭</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a>tf.random.set_seed(<span class="dv">43052</span>)</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a>cnv <span class="op">=</span> tf.keras.layers.Conv2D(<span class="dv">4</span>,kernel_size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb154-3"><a href="#cb154-3" aria-hidden="true" tabindex="-1"></a>XXX <span class="op">=</span> tnp.array([<span class="dv">1</span>]<span class="op">*</span><span class="dv">1</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">2</span><span class="op">*</span><span class="dv">3</span>,dtype<span class="op">=</span>tf.float64).reshape(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">3</span>) <span class="co">## X의 채널 차원 수를 늘림</span></span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:284,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704492598,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="a3055f50-cccc-4026-f229-54c1bb7c22bb">
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>cnv(XXX)</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="236">
<pre><code>&lt;tf.Tensor: shape=(1, 1, 1, 4), dtype=float32, numpy=
array([[[[ 0.3297621, -0.4498347, -1.0487393, -1.580095 ]]]],
      dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:267,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704591095,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="d6b51ac6-bfc6-4b3e-d657-75f4955a48f1">
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>cnv.weights <span class="co">## (2 x 2)는 커널 사이즈 // 3은 XXX의 채널 // 4는 conv(xxx) 출력 채널</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="238">
<pre><code>[&lt;tf.Variable 'conv2d_34/kernel:0' shape=(2, 2, 3, 4) dtype=float32, numpy=
 array([[[[-0.06956434, -0.12789628, -0.10784459, -0.32920673],
          [-0.30761963,  0.06209785, -0.07421023,  0.3941219 ],
          [ 0.16699678, -0.38913035, -0.13020593, -0.29443866]],
 
         [[ 0.28664726, -0.0697116 ,  0.09893084, -0.4221446 ],
          [-0.23161241, -0.16410837, -0.36420006,  0.12424195],
          [-0.14245945,  0.36286396, -0.10751781,  0.1733647 ]]],
 
 
        [[[ 0.02764335,  0.15547717, -0.42024496, -0.31893867],
          [ 0.22414821,  0.3619454 , -0.00282967, -0.3503708 ],
          [ 0.4610079 , -0.17417148,  0.00401336, -0.29777044]],
 
         [[-0.1620284 , -0.42066965, -0.01578814, -0.4240524 ],
          [ 0.37925082,  0.24236053,  0.3949356 , -0.20996472],
          [-0.30264795, -0.28889188, -0.3237777 ,  0.37506342]]]],
       dtype=float32)&gt;,
 &lt;tf.Variable 'conv2d_34/bias:0' shape=(4,) dtype=float32, numpy=array([0., 0., 0., 0.], dtype=float32)&gt;]</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704626742,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="a949ffbc-ffbb-45dc-e7af-4ef0e85a40ef">
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a>cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>] <span class="co">### cnv(XXX)의 첫번째 채널을 얻기위해 사용되는 weight값</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="239">
<pre><code>&lt;tf.Tensor: shape=(2, 2, 3), dtype=float32, numpy=
array([[[-0.06956434, -0.30761963,  0.16699678],
        [ 0.28664726, -0.23161241, -0.14245945]],

       [[ 0.02764335,  0.22414821,  0.4610079 ],
        [-0.1620284 ,  0.37925082, -0.30264795]]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:256,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704663240,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="652c3bf3-ade9-46cd-8a95-f6b619c81cd4">
<div class="sourceCode cell-code" id="cb161"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="#cb161-1" aria-hidden="true" tabindex="-1"></a>tf.reduce_sum(cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>]) <span class="co">## 오 cnv(XXX)의 첫번째 값과 같다. 즉 첫번째 채널의 결과 ## 이거 시험에 안나오니 정리만!!</span></span>
<span id="cb161-2"><a href="#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="co">## 채널이 뻥튀기 될 때 뻥튀기 된 채널이 아무의미가 없고 유의미한 피쳐가 있을 것이라고 기대하는 것이다 즉 그중에 강아지인지, 고양이지인지 그중에 하나만 걸려라의 느낌의 뻥튀기</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="240">
<pre><code>&lt;tf.Tensor: shape=(), dtype=float32, numpy=0.32976213&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:2,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704850535,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="9b5c7309-5016-4598-ba28-007209a79030">
<div class="sourceCode cell-code" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tf.reduce_sum(cnv.weights[<span class="dv">0</span>][...,<span class="dv">1</span>])) <span class="co">## 두 번째 cnv(XXX)</span></span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tf.reduce_sum(cnv.weights[<span class="dv">0</span>][...,<span class="dv">2</span>])) <span class="co">## 두 번째 cnv(XXX)</span></span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(tf.reduce_sum(cnv.weights[<span class="dv">0</span>][...,<span class="dv">3</span>])) <span class="co">## 두 번째 cnv(XXX)</span></span></code></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>tf.Tensor(-0.44983464, shape=(), dtype=float32)
tf.Tensor(-1.0487392, shape=(), dtype=float32)
tf.Tensor(-1.5800952, shape=(), dtype=float32)</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a>w_red <span class="op">=</span> cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>][...,<span class="dv">0</span>] <span class="co">## X의 입력 채널</span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>w_green <span class="op">=</span> cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>][...,<span class="dv">1</span>] <span class="co">## X의 입력 채널</span></span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a>w_blue <span class="op">=</span> cnv.weights[<span class="dv">0</span>][...,<span class="dv">0</span>][...,<span class="dv">2</span>] <span class="co">## X의 입력 채널</span></span></code></pre></div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:265,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652704989403,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="4de001fb-2634-4391-d267-8a1c65ff0e93">
<div class="sourceCode cell-code" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="#cb166-1" aria-hidden="true" tabindex="-1"></a>w_red</span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="250">
<pre><code>&lt;tf.Tensor: shape=(2, 2), dtype=float32, numpy=
array([[-0.06956434,  0.28664726],
       [ 0.02764335, -0.1620284 ]], dtype=float32)&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:274,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652705094565,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="c721efab-566f-41dd-9795-c94b9ae49f85">
<div class="sourceCode cell-code" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a>XXX[...,<span class="dv">0</span>]<span class="op">*</span>w_red  <span class="op">+</span>  XXX[...,<span class="dv">1</span>] <span class="op">*</span> w_green  <span class="op">+</span> XXX[...,<span class="dv">2</span>] <span class="op">*</span> w_blue </span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="253">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2), dtype=float64, numpy=
array([[[-0.2101872 , -0.08742461],
        [ 0.71279946, -0.08542553]]])&gt;</code></pre>
</div>
</div>
<div class="cell" data-executioninfo="{&quot;elapsed&quot;:256,&quot;status&quot;:&quot;ok&quot;,&quot;timestamp&quot;:1652705010657,&quot;user&quot;:{&quot;displayName&quot;:&quot;이강철&quot;,&quot;userId&quot;:&quot;13507850890638580947&quot;},&quot;user_tz&quot;:-540}" data-outputid="3e5b1e90-74ba-437a-ae4f-430f6ed108df">
<div class="sourceCode cell-code" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a>XXX[...,<span class="dv">0</span>] <span class="co">## X_red</span></span></code></pre></div>
<div class="cell-output cell-output-display" data-execution_count="252">
<pre><code>&lt;tf.Tensor: shape=(1, 2, 2), dtype=float64, numpy=
array([[[1., 1.],
        [1., 1.]]])&gt;</code></pre>
</div>
</div>
<ul>
<li>만약 layer의 acitvation을 relu로 잡으면 음의값은 전부 0으로 바뀐다.</li>
</ul>
</section>
</section>
<section id="텐서플로우를-공부하기-좋은-교재-혹은-참고자료" class="level2">
<h2 class="anchored" data-anchor-id="텐서플로우를-공부하기-좋은-교재-혹은-참고자료">텐서플로우를 공부하기 좋은 교재 혹은 참고자료</h2>
<section id="텐서플로우-교재" class="level4">
<h4 class="anchored" data-anchor-id="텐서플로우-교재">텐서플로우 교재</h4>
<p><code>-</code> 교재1: http://www.kyobobook.co.kr/product/detailViewEng.laf?mallGb=ENG&amp;ejkGb=ENG&amp;barcode=9781838823412 - 장점: 텐서플로우 2.0을 다룬 교재, 기본적 내용을 간략히 소개. 다양한 분야를 커버. - 단점: 내용이 조금 산만함 (잘 안읽힘). 코드가 예쁘지 않음. 글을 진짜 못씀.</p>
<p><code>-</code> 교재2: https://www.amazon.com/Advanced-Deep-Learning-TensorFlow-Keras/dp/1838821651/ref=pd_sbs_sccl_2_2/139-5369471-9501726?pd_rd_w=PLPU2&amp;pf_rd_p=3676f086-9496-4fd7-8490-77cf7f43f846&amp;pf_rd_r=019BZNCP8B6RHXPKXF0T&amp;pd_rd_r=2dea359c-c5d4-4404-86d8-cb1f5f934607&amp;pd_rd_wg=98kmk&amp;pd_rd_i=1838821651&amp;psc=1</p>
<ul>
<li>장점: 코드가 예쁘다. 예제가 잘 구성됨. 참신하다. 내용에 깊이가 있다.</li>
<li>단점: 입문용 내용이 아예 없음</li>
</ul>
<p><code>-</code> 교재3: 텐서플로 딥러닝 프로그래밍 (김동근/가메출판사) - 장점: 한글교재, 그래도 교재구성에 흐름이 있다. 공식문서의 가이드내용도 포함 (대부분은 튜토리얼 수준만 포함) - 단점: 공식문서내용 그냥 거의 그대로 베낌.</p>
</section>
<section id="공식홈페이지" class="level4">
<h4 class="anchored" data-anchor-id="공식홈페이지">공식홈페이지</h4>
<p><code>-</code> 튜토리얼: https://www.tensorflow.org/tutorials?hl=ko - 탭눌러서 초보자~고급 모두 읽어보면 좋다. - 간단한 모형실습들 제공. - 대부분의 교재는 튜토리얼의 내용을 베껴서 출판한다. (외국교재도 포함!)</p>
<p><code>-</code> 가이드: https://www.tensorflow.org/guide?hl=ko - 왜 파이토치가 아니고 텐서플로우를 써야하는가? 에 대한 대답들 - 모형에 대한 설명보다 프로그램 자체에 대한 이해도를 높여준다.</p>
<p><code>-</code> API: https://www.tensorflow.org/versions?hl=ko - tf의 다양한 모듈구조를 확인 - 파이썬에서 도움말 치면 나오는 것들 + <span class="math inline">\(\alpha\)</span> - 교재에서 확인불가능한 아주 디테일한 부분까지 확인가능</p>
<div class="cell" data-outputid="97d094dc-c844-4514-d043-b640f0ba0876">
<div class="sourceCode cell-code" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="#cb172-1" aria-hidden="true" tabindex="-1"></a>tf.GradientTape?</span></code></pre></div>
<div class="cell-output cell-output-display">
<div class="ansi-escaped-output">
<pre><span class="ansi-red-fg">Init signature:</span> tf<span class="ansi-blue-fg">.</span>GradientTape<span class="ansi-blue-fg">(</span>persistent<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">False</span><span class="ansi-blue-fg">,</span> watch_accessed_variables<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>     
Record operations for automatic differentiation.
Operations are recorded if they are executed within this context manager and
at least one of their inputs is being "watched".
Trainable variables (created by `tf.Variable` or `tf.compat.v1.get_variable`,
where `trainable=True` is default in both cases) are automatically watched.
Tensors can be manually watched by invoking the `watch` method on this context
manager.
For example, consider the function `y = x * x`. The gradient at `x = 3.0` can
be computed as:
&gt;&gt;&gt; x = tf.constant(3.0)
&gt;&gt;&gt; with tf.GradientTape() as g:
...   g.watch(x)
...   y = x * x
&gt;&gt;&gt; dy_dx = g.gradient(y, x)
&gt;&gt;&gt; print(dy_dx)
tf.Tensor(6.0, shape=(), dtype=float32)
GradientTapes can be nested to compute higher-order derivatives. For example,
&gt;&gt;&gt; x = tf.constant(5.0)
&gt;&gt;&gt; with tf.GradientTape() as g:
...   g.watch(x)
...   with tf.GradientTape() as gg:
...     gg.watch(x)
...     y = x * x
...   dy_dx = gg.gradient(y, x)  # dy_dx = 2 * x
&gt;&gt;&gt; d2y_dx2 = g.gradient(dy_dx, x)  # d2y_dx2 = 2
&gt;&gt;&gt; print(dy_dx)
tf.Tensor(10.0, shape=(), dtype=float32)
&gt;&gt;&gt; print(d2y_dx2)
tf.Tensor(2.0, shape=(), dtype=float32)
By default, the resources held by a GradientTape are released as soon as
GradientTape.gradient() method is called. To compute multiple gradients over
the same computation, create a persistent gradient tape. This allows multiple
calls to the gradient() method as resources are released when the tape object
is garbage collected. For example:
&gt;&gt;&gt; x = tf.constant(3.0)
&gt;&gt;&gt; with tf.GradientTape(persistent=True) as g:
...   g.watch(x)
...   y = x * x
...   z = y * y
&gt;&gt;&gt; dz_dx = g.gradient(z, x)  # (4*x^3 at x = 3)
&gt;&gt;&gt; print(dz_dx)
tf.Tensor(108.0, shape=(), dtype=float32)
&gt;&gt;&gt; dy_dx = g.gradient(y, x)
&gt;&gt;&gt; print(dy_dx)
tf.Tensor(6.0, shape=(), dtype=float32)
By default GradientTape will automatically watch any trainable variables that
are accessed inside the context. If you want fine grained control over which
variables are watched you can disable automatic tracking by passing
`watch_accessed_variables=False` to the tape constructor:
&gt;&gt;&gt; x = tf.Variable(2.0)
&gt;&gt;&gt; w = tf.Variable(5.0)
&gt;&gt;&gt; with tf.GradientTape(
...     watch_accessed_variables=False, persistent=True) as tape:
...   tape.watch(x)
...   y = x ** 2  # Gradients will be available for `x`.
...   z = w ** 3  # No gradients will be available as `w` isn't being watched.
&gt;&gt;&gt; dy_dx = tape.gradient(y, x)
&gt;&gt;&gt; print(dy_dx)
tf.Tensor(4.0, shape=(), dtype=float32)
&gt;&gt;&gt; # No gradients will be available as `w` isn't being watched.
&gt;&gt;&gt; dz_dy = tape.gradient(z, w)
&gt;&gt;&gt; print(dz_dy)
None
Note that when using models you should ensure that your variables exist when
using `watch_accessed_variables=False`. Otherwise it's quite easy to make your
first iteration not have any gradients:
```python
a = tf.keras.layers.Dense(32)
b = tf.keras.layers.Dense(32)
with tf.GradientTape(watch_accessed_variables=False) as tape:
  tape.watch(a.variables)  # Since `a.build` has not been called at this point
                           # `a.variables` will return an empty list and the
                           # tape will not be watching anything.
  result = b(a(inputs))
  tape.gradient(result, a.variables)  # The result of this computation will be
                                      # a list of `None`s since a's variables
                                      # are not being watched.
Note that only tensors with real or complex dtypes are differentiable. <span class="ansi-red-fg">Init docstring:</span> Creates a new GradientTape. Args: persistent: Boolean controlling whether a persistent gradient tape is created. False by default, which means at most one call can be made to the gradient() method on this object. watch_accessed_variables: Boolean controlling whether the tape will automatically <code>watch</code> any (trainable) variables accessed while the tape is active. Defaults to True meaning gradients can be requested from any result computed in the tape derived from reading a trainable <code>Variable</code>. If False users must explicitly <code>watch</code> any <code>Variable</code>s they want to request gradients from. <span class="ansi-red-fg">File:</span> ~/anaconda3/envs/tfgpu/lib/python3.10/site-packages/tensorflow/python/eager/backprop.py <span class="ansi-red-fg">Type:</span> type <span class="ansi-red-fg">Subclasses:</span> LossScaleGradientTape
</pre>
<p>```</p>
</div>
</div>
</div>
</section>
<section id="텐서플로우가-아닌-그냥-딥러닝-이론교재" class="level4">
<h4 class="anchored" data-anchor-id="텐서플로우가-아닌-그냥-딥러닝-이론교재">텐서플로우가 아닌 그냥 딥러닝 이론교재</h4>
<p><code>-</code> Deep Learning (이안굿펠로우): https://www.aladin.co.kr/shop/wproduct.aspx?ItemId=171345378 - 장점: 그나마 잘 쓰여진 전통있는 교재, 교수님들 책꽃이에 하나씩 꼽혀있었음. 방대한 내용다룸. 깊이있음. 틀린것 없음. 무료 - 단점: 번역이 쓰레기임. 내용이 너무 어려움. (이해를 하라고 쓴 설명이 아님) - 무료제공: https://www.deeplearningbook.org/</p>
<p><code>-</code> 기계학습 (오일석) - 장점: 이해가 잘된다. 꽤 넓은 분야를 다룬다. 비교적 간단한 예제로 개념을 설명한다.</p>
</section>
<section id="cnn의-시작-알렉스넷" class="level3">
<h3 class="anchored" data-anchor-id="cnn의-시작-알렉스넷">CNN의 시작: 알렉스넷</h3>
<p><code>-</code> 만화: https://wedatalab.tistory.com/71</p>
</section>
<section id="d-convolution" class="level3">
<h3 class="anchored" data-anchor-id="d-convolution">2d convolution</h3>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'alternate';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>